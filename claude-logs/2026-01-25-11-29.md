# Mobile Layout Fix & Game Data i18n

## Date: 2026-01-25

## Summary
Fixed mobile layout to show 2 items per row on category pages and added i18n support for game data.

## Changes Made

### 1. Mobile Layout Fix (Category Page)

Updated `src/app/[locale]/games/[gameSlug]/[categorySlug]/page.module.css`:
- Changed default grid from 1 column to 2 columns
- Reduced gap on mobile from `--spacing-md` to `--spacing-sm`
- Made entity content more compact on mobile with smaller padding and font sizes
- Added responsive breakpoints that increase columns at 768px (3 cols) and 1024px (4 cols)

### 2. Game Data i18n Support

#### Updated Data Loader (`src/lib/data/loader.ts`)
- Added `locale` parameter to all loader functions (defaults to 'en')
- Created `mergeTranslations()` helper to merge locale-specific text fields
- Created `tryLoadLocaleFile()` helper to safely load locale files
- Updated functions:
  - `loadGameMeta(gameSlug, locale)`
  - `loadEntities(gameSlug, entityType, locale)`
  - `loadEntityBySlug(gameSlug, entityType, entitySlug, locale)`
  - `loadGameData(gameSlug, locale)`
  - `loadAvailableGames(locale)`
  - `searchEntities(gameSlug, entityType, query, locale)`
  - `filterEntities(gameSlug, entityType, predicate, locale)`

#### Created Chinese Translation Files
- `src/data/games/wittle-defender/_meta.zh.json` - Game metadata
- `src/data/games/wittle-defender/heroes.zh.json` - 15 heroes translated
- `src/data/games/wittle-defender/skills.zh.json` - 30 skills translated
- `src/data/games/wittle-defender/dungeons.zh.json` - 9 dungeons translated

Translation file format (keyed by entity ID):
```json
{
  "hero-001": {
    "name": "烬炎骑士",
    "description": "无畏的战士，挥舞火焰..."
  }
}
```

#### Updated Pages to Use Locale
All pages now pass locale to data loaders:
- `src/app/[locale]/page.tsx`
- `src/app/[locale]/games/page.tsx`
- `src/app/[locale]/games/[gameSlug]/page.tsx`
- `src/app/[locale]/games/[gameSlug]/[categorySlug]/page.tsx`
- `src/app/[locale]/games/[gameSlug]/[categorySlug]/[itemSlug]/page.tsx`

## How It Works

1. Base data files (e.g., `heroes.json`) contain English content
2. Locale-specific files (e.g., `heroes.zh.json`) contain only translated fields
3. Loader merges translations into base data when loading with a non-default locale
4. Pages extract locale from URL params and pass to loaders

## Build & Test Results
- Build: **Success** (131 static pages)
- Tests: **18 passed**
