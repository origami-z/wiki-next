Perfect! I've successfully added comprehensive tests to cover the middleware location bug fix. Here's what was implemented:

## Test Suite Added

### 1. **Middleware Location Tests** (`__tests__/middleware-location.test.ts`)
Tests that verify the middleware file is in the correct location (`src/middleware.ts`) - the key fix for the routing bug:
- ✓ Middleware is at `src/middleware.ts` (not project root)
- ✓ Has correct exports and configuration
- ✓ Includes proper matcher patterns
- ✓ Uses next-intl with routing config

### 2. **LocaleSwitch Component Tests** (`__tests__/components/LocaleSwitch.test.tsx`)
Unit tests for the locale switching component:
- ✓ Displays correct locale indicator (EN/中)
- ✓ Switches between locales correctly
- ✓ Preserves pathname when switching
- ✓ Has proper accessibility attributes

### 3. **E2E Locale Routing Tests** (`e2e/locale-routing.spec.ts`)
Playwright tests that verify the entire locale routing flow:
- ✓ Root path loads English content
- ✓ `/zh` loads Chinese content
- ✓ `/en` redirects to root (as-needed strategy)
- ✓ Locale switching via UI works
- ✓ Translation strings load correctly
- ✓ Middleware excludes API and `_next` routes

## Test Results
```
Jest Tests: 18 passed
Playwright E2E: 10 passed, 1 skipped

Total Coverage: Middleware location, locale routing, and component behavior
```

## Configuration Files Added
- `jest.config.js` - Jest configuration with Next.js integration
- `jest.setup.js` - Jest setup with Testing Library
- `playwright.config.ts` - Playwright E2E configuration
- `TEST_README.md` - Comprehensive test documentation
- Updated `.gitignore` - Exclude test artifacts

## New npm Scripts
```bash
npm test              # Run unit tests
npm run test:watch    # Watch mode
npm run test:coverage # With coverage report
npm run test:e2e      # Run E2E tests
npm run test:e2e:ui   # E2E with UI
npm run test:all      # Run all tests
```

These tests ensure the middleware location bug is caught if it regresses, and verify that locale routing works correctly across all scenarios!

✻ Baked for 1448m 31s
